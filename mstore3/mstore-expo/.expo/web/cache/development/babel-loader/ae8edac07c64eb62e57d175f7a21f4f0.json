{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar Facebook = _interopRequireWildcard(require(\"expo-facebook\"));\n\nvar _common = require(\"@common\");\n\nvar _Omni = require(\"@app/Omni\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar FacebookAPI = function () {\n  function FacebookAPI() {\n    (0, _classCallCheck2.default)(this, FacebookAPI);\n  }\n\n  (0, _createClass2.default)(FacebookAPI, [{\n    key: \"login\",\n    value: function login() {\n      var ask, type, token;\n      return _regenerator.default.async(function login$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regenerator.default.awrap(Facebook.initializeAsync({\n                appId: _common.Config.appFacebookId,\n                appName: \"MStore\"\n              }));\n\n            case 2:\n              _context.next = 4;\n              return _regenerator.default.awrap(Facebook.logInWithReadPermissionsAsync({\n                permissions: [\"public_profile\", \"email\"]\n              }));\n\n            case 4:\n              ask = _context.sent;\n              type = ask.type;\n\n              if (!(type === \"success\")) {\n                _context.next = 9;\n                break;\n              }\n\n              token = ask.token;\n              return _context.abrupt(\"return\", token);\n\n            case 9:\n              return _context.abrupt(\"return\", null);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      Facebook.logOut();\n    }\n  }, {\n    key: \"getAccessToken\",\n    value: function getAccessToken() {\n      return _regenerator.default.async(function getAccessToken$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt(\"return\", Facebook.getCurrentFacebook());\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n  }, {\n    key: \"shareLink\",\n    value: function shareLink(link, desc) {\n      var shareLinkContent, canShow, result;\n      return _regenerator.default.async(function shareLink$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              shareLinkContent = {\n                contentType: \"link\",\n                contentUrl: link,\n                contentDescription: desc\n              };\n              _context3.prev = 1;\n              _context3.next = 4;\n              return _regenerator.default.awrap(Facebook.canShow(shareLinkContent));\n\n            case 4:\n              canShow = _context3.sent;\n\n              if (!canShow) {\n                _context3.next = 10;\n                break;\n              }\n\n              _context3.next = 8;\n              return _regenerator.default.awrap(Facebook.show(shareLinkContent));\n\n            case 8:\n              result = _context3.sent;\n\n              if (!result.isCancelled) {\n                (0, _Omni.toast)(\"Post shared\");\n                (0, _Omni.log)(\"Share a post with id: \" + result.postId);\n              }\n\n            case 10:\n              _context3.next = 16;\n              break;\n\n            case 12:\n              _context3.prev = 12;\n              _context3.t0 = _context3[\"catch\"](1);\n              (0, _Omni.toast)(\"An error occurred. Please try again later\");\n\n              _context3.t0(\"Share post fail with error: \" + _context3.t0);\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, [[1, 12]], Promise);\n    }\n  }]);\n  return FacebookAPI;\n}();\n\nvar _default = new FacebookAPI();\n\nexports.default = _default;","map":{"version":3,"sources":["/Users/javadoge/mstore3/mstore-expo/src/services/FacebookAPI.js"],"names":["FacebookAPI","Facebook","initializeAsync","appId","Config","appFacebookId","appName","logInWithReadPermissionsAsync","permissions","ask","type","token","logOut","getCurrentFacebook","link","desc","shareLinkContent","contentType","contentUrl","contentDescription","canShow","show","result","isCancelled","postId"],"mappings":";;;;;;;;;;;;;AAEA;;AAEA;;AACA;;;;;;IAEMA,W;;;;;;;;;;;;;;gDAEIC,QAAQ,CAACC,eAAT,CAAyB;AAC7BC,gBAAAA,KAAK,EAAEC,eAAOC,aADe;AAE7BC,gBAAAA,OAAO,EAAE;AAFoB,eAAzB,C;;;;gDAKYL,QAAQ,CAACM,6BAAT,CAAuC;AACvDC,gBAAAA,WAAW,EAAE,CAAC,gBAAD,EAAmB,OAAnB;AAD0C,eAAvC,C;;;AAAZC,cAAAA,G;AAGEC,cAAAA,I,GAASD,G,CAATC,I;;oBAEJA,IAAI,KAAK,S;;;;;AACHC,cAAAA,K,GAAUF,G,CAAVE,K;+CAEDA,K;;;+CAEF,I;;;;;;;;;;;6BAGA;AACPV,MAAAA,QAAQ,CAACW,MAAT;AACD;;;;;;;;gDAGQX,QAAQ,CAACY,kBAAT,E;;;;;;;;;;;8BAGOC,I,EAAMC,I;;;;;;AACdC,cAAAA,gB,GAAmB;AACvBC,gBAAAA,WAAW,EAAE,MADU;AAEvBC,gBAAAA,UAAU,EAAEJ,IAFW;AAGvBK,gBAAAA,kBAAkB,EAAEJ;AAHG,e;;;gDAMDd,QAAQ,CAACmB,OAAT,CAAiBJ,gBAAjB,C;;;AAAhBI,cAAAA,O;;mBACFA,O;;;;;;gDACmBnB,QAAQ,CAACoB,IAAT,CAAcL,gBAAd,C;;;AAAfM,cAAAA,M;;AACN,kBAAI,CAACA,MAAM,CAACC,WAAZ,EAAyB;AACvB,iCAAM,aAAN;AACA,0DAA6BD,MAAM,CAACE,MAApC;AACD;;;;;;;;;AAGH,+BAAM,2CAAN;;AACA;;;;;;;;;;;;;eAKS,IAAIxB,WAAJ,E","sourcesContent":["/** @format */\n\nimport * as Facebook from \"expo-facebook\";\n\nimport { Config } from \"@common\";\nimport { toast, log } from \"@app/Omni\";\n\nclass FacebookAPI {\n  async login() {\n    await Facebook.initializeAsync({\n      appId: Config.appFacebookId,\n      appName: \"MStore\",\n    });\n\n    const ask = await Facebook.logInWithReadPermissionsAsync({\n      permissions: [\"public_profile\", \"email\"],\n    });\n    const { type } = ask;\n\n    if (type === \"success\") {\n      const { token } = ask;\n\n      return token;\n    }\n    return null;\n  }\n\n  logout() {\n    Facebook.logOut();\n  }\n\n  async getAccessToken() {\n    return Facebook.getCurrentFacebook();\n  }\n\n  async shareLink(link, desc) {\n    const shareLinkContent = {\n      contentType: \"link\",\n      contentUrl: link,\n      contentDescription: desc,\n    };\n    try {\n      const canShow = await Facebook.canShow(shareLinkContent);\n      if (canShow) {\n        const result = await Facebook.show(shareLinkContent);\n        if (!result.isCancelled) {\n          toast(\"Post shared\");\n          log(`Share a post with id: ${result.postId}`);\n        }\n      }\n    } catch (error) {\n      toast(\"An error occurred. Please try again later\");\n      error(`Share post fail with error: ${error}`);\n    }\n  }\n}\n\nexport default new FacebookAPI();\n"]},"metadata":{},"sourceType":"script"}